---
title: "p8105_hw5_sy3352"
author: "Su Yan"
date: "2025-11-05"
output: github_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(rvest)
set.seed(1)
```

## Problem 1

```{r}
same_bday = function(n) {
  generated_bday = sample(1:365, n, replace = TRUE)
  tibble(duplicate_bday = any(duplicated(generated_bday)))
}

sim_results_df = 
  expand_grid(
    sample_size = 2:50,
    iter = 1:10000
  ) |> 
  mutate(
    estimate_df = map(sample_size, same_bday)
  ) |> 
  unnest(estimate_df)

same_bday_prob = sim_results_df |> 
  group_by(sample_size) |> 
  summarize(same_bday_probability = mean(duplicate_bday))

same_bday_prob_pt = same_bday_prob |> 
  ggplot(aes(x = sample_size,
             y = same_bday_probability)) + 
  geom_line()
same_bday_prob_pt
```

